<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第7章 粒子与精灵 | Notebook</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="个人学习记录，资料收集备忘">
    
    <link rel="preload" href="/assets/css/0.styles.6905d551.css" as="style"><link rel="preload" href="/assets/js/app.377ebb8d.js" as="script"><link rel="preload" href="/assets/js/2.3ff17b28.js" as="script"><link rel="preload" href="/assets/js/13.49d0da8a.js" as="script"><link rel="prefetch" href="/assets/js/10.e0665bde.js"><link rel="prefetch" href="/assets/js/11.75b0e6df.js"><link rel="prefetch" href="/assets/js/12.3b062665.js"><link rel="prefetch" href="/assets/js/14.f17b3ad7.js"><link rel="prefetch" href="/assets/js/15.920a5ec9.js"><link rel="prefetch" href="/assets/js/16.0f08803f.js"><link rel="prefetch" href="/assets/js/17.f9597354.js"><link rel="prefetch" href="/assets/js/18.a6cf6487.js"><link rel="prefetch" href="/assets/js/19.2134f4eb.js"><link rel="prefetch" href="/assets/js/20.31170820.js"><link rel="prefetch" href="/assets/js/21.b655d938.js"><link rel="prefetch" href="/assets/js/22.1fd5d38a.js"><link rel="prefetch" href="/assets/js/23.2d643e1a.js"><link rel="prefetch" href="/assets/js/24.8a6aa69e.js"><link rel="prefetch" href="/assets/js/25.8a3964a7.js"><link rel="prefetch" href="/assets/js/26.b8c3d73c.js"><link rel="prefetch" href="/assets/js/27.b8ffb725.js"><link rel="prefetch" href="/assets/js/28.3ad7fe69.js"><link rel="prefetch" href="/assets/js/29.91f82f4b.js"><link rel="prefetch" href="/assets/js/3.ab59f89e.js"><link rel="prefetch" href="/assets/js/30.5cd81caf.js"><link rel="prefetch" href="/assets/js/31.d60c8a8c.js"><link rel="prefetch" href="/assets/js/32.32390379.js"><link rel="prefetch" href="/assets/js/33.a5be0262.js"><link rel="prefetch" href="/assets/js/34.f133cbe1.js"><link rel="prefetch" href="/assets/js/35.43c62a92.js"><link rel="prefetch" href="/assets/js/36.801f2d43.js"><link rel="prefetch" href="/assets/js/37.26eed37a.js"><link rel="prefetch" href="/assets/js/38.6fbf7986.js"><link rel="prefetch" href="/assets/js/39.87b5ff8c.js"><link rel="prefetch" href="/assets/js/4.8519368b.js"><link rel="prefetch" href="/assets/js/40.14747b79.js"><link rel="prefetch" href="/assets/js/41.9231be58.js"><link rel="prefetch" href="/assets/js/42.7712b544.js"><link rel="prefetch" href="/assets/js/43.42a10ddc.js"><link rel="prefetch" href="/assets/js/44.78086a47.js"><link rel="prefetch" href="/assets/js/45.dee7a6e3.js"><link rel="prefetch" href="/assets/js/46.8da62188.js"><link rel="prefetch" href="/assets/js/47.c5598733.js"><link rel="prefetch" href="/assets/js/48.593f6527.js"><link rel="prefetch" href="/assets/js/49.76d7cc0b.js"><link rel="prefetch" href="/assets/js/5.1bc6cf05.js"><link rel="prefetch" href="/assets/js/50.4a35efe5.js"><link rel="prefetch" href="/assets/js/51.6dd65d75.js"><link rel="prefetch" href="/assets/js/52.a89314e2.js"><link rel="prefetch" href="/assets/js/53.2c6b85c4.js"><link rel="prefetch" href="/assets/js/54.73e04800.js"><link rel="prefetch" href="/assets/js/55.189a12ce.js"><link rel="prefetch" href="/assets/js/56.583e3029.js"><link rel="prefetch" href="/assets/js/57.458cfa8a.js"><link rel="prefetch" href="/assets/js/58.146e1aaa.js"><link rel="prefetch" href="/assets/js/59.60f3c481.js"><link rel="prefetch" href="/assets/js/6.3e742d53.js"><link rel="prefetch" href="/assets/js/60.4c8a7df2.js"><link rel="prefetch" href="/assets/js/61.7e814d91.js"><link rel="prefetch" href="/assets/js/62.7f089076.js"><link rel="prefetch" href="/assets/js/63.c930cbaf.js"><link rel="prefetch" href="/assets/js/64.78e10c4c.js"><link rel="prefetch" href="/assets/js/7.dceefd90.js"><link rel="prefetch" href="/assets/js/8.2918149c.js"><link rel="prefetch" href="/assets/js/9.2e4a03b2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6905d551.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Notebook" class="logo"> <span class="site-name can-hide">Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记分类" class="dropdown-title"><span class="title">笔记分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记分类" class="mobile-dropdown-title"><span class="title">笔记分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><a href="http://wanje.gitee.io/learning_notes/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更多
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记分类" class="dropdown-title"><span class="title">笔记分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记分类" class="mobile-dropdown-title"><span class="title">笔记分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><a href="http://wanje.gitee.io/learning_notes/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  更多
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/html/a标签的各种用途.html" class="sidebar-link">a标签的各种用途</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/JS零散集.html" class="sidebar-link">JS零散集</a></li><li><a href="/js/数据类型概览.html" class="sidebar-link">JS数据类型概览</a></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ES6+</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/es6+/Class.html" class="sidebar-link">Class</a></li><li><a href="/js/es6+/Promise.html" class="sidebar-link">Promise</a></li><li><a href="/js/es6+/async-await.html" class="sidebar-link">async/await</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/css/scss语法.html" class="sidebar-link">SCSS基础语法</a></li><li><a href="/css/flex弹性布局.html" class="sidebar-link">flex弹性布局</a></li><li><a href="/css/CSS选择器世界.html" class="sidebar-link">CSS选择器世界</a></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>CSS世界</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/css/CSS世界/层叠规则.html" class="sidebar-link">层叠规则</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>绘图&amp;动画</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/draw-animation/D3js.html" class="sidebar-link">D3.js</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Threejs开发指南</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/draw-animation/Threejs开发指南/第1章.html" class="sidebar-link">第1章 概览</a></li><li><a href="/draw-animation/Threejs开发指南/第2章.html" class="sidebar-link">第2章 构建Three.js应用的基本组件</a></li><li><a href="/draw-animation/Threejs开发指南/第3章.html" class="sidebar-link">第3章 学习使用Three.js中的光源</a></li><li><a href="/draw-animation/Threejs开发指南/第4章.html" class="sidebar-link">第4章 使用Three.js的材质</a></li><li><a href="/draw-animation/Threejs开发指南/第5章.html" class="sidebar-link">第5章 学习使用几何体</a></li><li><a href="/draw-animation/Threejs开发指南/第6章.html" class="sidebar-link">第6章 高级几何体和二元操作</a></li><li><a href="/draw-animation/Threejs开发指南/第7章.html" class="active sidebar-link">第7章 粒子与精灵</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/draw-animation/Threejs开发指南/第7章.html#_7-1-理解粒子" class="sidebar-link">7.1 理解粒子</a></li><li class="sidebar-sub-header"><a href="/draw-animation/Threejs开发指南/第7章.html#_7-2-three-points和three-pointsmaterial" class="sidebar-link">7.2 THREE.Points和THREE.PointsMaterial</a></li><li class="sidebar-sub-header"><a href="/draw-animation/Threejs开发指南/第7章.html#_7-3-使用h5-canvas画布样式化粒子" class="sidebar-link">7.3 使用H5-Canvas画布样式化粒子</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/draw-animation/Threejs开发指南/第7章.html#_7-3-1-在canvasrenderer中使用html5画布" class="sidebar-link">7.3.1 在CanvasRenderer中使用HTML5画布</a></li><li class="sidebar-sub-header"><a href="/draw-animation/Threejs开发指南/第7章.html#_7-3-2-在webglrenderer中使用html5画布" class="sidebar-link">7.3.2 在WebGLRenderer中使用HTML5画布</a></li></ul></li><li class="sidebar-sub-header"><a href="/draw-animation/Threejs开发指南/第7章.html#_7-4-使用纹理样式化粒子" class="sidebar-link">7.4 使用纹理样式化粒子</a></li><li class="sidebar-sub-header"><a href="/draw-animation/Threejs开发指南/第7章.html#_7-5-使用精灵贴图" class="sidebar-link">7.5 使用精灵贴图</a></li><li class="sidebar-sub-header"><a href="/draw-animation/Threejs开发指南/第7章.html#_7-6-从高级几何体创建three-points" class="sidebar-link">7.6 从高级几何体创建THREE.Points</a></li></ul></li><li><a href="/draw-animation/Threejs开发指南/第8章.html" class="sidebar-link">第8章 创建/加载高级网格和几何体</a></li><li><a href="/draw-animation/Threejs开发指南/第9章.html" class="sidebar-link">第9章 创建动画和移动摄像机</a></li><li><a href="/draw-animation/Threejs开发指南/第10章.html" class="sidebar-link">第10章 加载和使用纹理</a></li><li><a href="/draw-animation/Threejs开发指南/第11章.html" class="sidebar-link">第11章 自定义着色器和后期处理</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/vue工程配置.html" class="sidebar-link">Vue工程创建及配置</a></li><li><a href="/vue/vue基础语法.html" class="sidebar-link">Vue基础语法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/react工程配置.html" class="sidebar-link">React工程创建及配置</a></li><li><a href="/react/react基础语法.html" class="sidebar-link">React基础语法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/typescript/类型/为什么需要类型.html" class="sidebar-link">为什么需要类型</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>类型</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>泛型</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>类型转换</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/typescript/模块/CommonJS兼容模块.html" class="sidebar-link">CommonJS兼容模块</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>命名空间</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>理解声明</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/node/Node模块机制.html" class="sidebar-link">Node模块机制与NPM包</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/webpack/webpack4.x笔记.html" class="sidebar-link">webpack4.x笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Python</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/python/python基础语法.html" class="sidebar-link">Python基础语法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/others/Markdown语法.html" class="sidebar-link">Markdown语法</a></li><li><a href="/others/Git使用.html" class="sidebar-link">Git使用</a></li><li><a href="/others/Gulp使用.html" class="sidebar-link">Gulp使用</a></li><li><a href="/others/环境&amp;软件安装.html" class="sidebar-link">环境&amp;软件安装</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="第7章-粒子与精灵"><a href="#第7章-粒子与精灵" class="header-anchor">#</a> 第7章 粒子与精灵</h1> <p>目录
</p><div class="table-of-contents"><ul><li><a href="#_7-1-理解粒子">7.1 理解粒子</a></li><li><a href="#_7-2-three-points-和-three-pointsmaterial">7.2 THREE.Points和THREE.PointsMaterial</a></li><li><a href="#_7-3-使用h5-canvas画布样式化粒子">7.3 使用H5-Canvas画布样式化粒子</a><ul><li><a href="#_7-3-1-在-canvasrenderer-中使用html5画布">7.3.1 在CanvasRenderer中使用HTML5画布</a></li><li><a href="#_7-3-2-在-webglrenderer-中使用html5画布">7.3.2 在WebGLRenderer中使用HTML5画布</a></li></ul></li><li><a href="#_7-4-使用纹理样式化粒子">7.4 使用纹理样式化粒子</a></li><li><a href="#_7-5-使用精灵贴图">7.5 使用精灵贴图</a></li><li><a href="#_7-6-从高级几何体创建-three-points">7.6 从高级几何体创建THREE.Points</a></li></ul></div><p></p> <p>这里的粒子(points)与精灵(sprite)概念上是同一个概念(只是适用场景不一样)，可用于创建很多细小的物体(都可看做是一个点)，用来模拟雨滴、雪花、烟雾等一些效果(这里的雨滴、雪花就是一个粒子/精灵)。可能主要区别只是精灵是每个点都独立控制，一般用于数量不太多的情况，而粒子是将所有点一起控制(将所有粒子作为一个几何体的顶点，从而形成一体粒子云)，可用于数量大的情况。这些每个点的物体正面都始终面向摄像机，不管从哪个角度看，他们都会自动旋转。默认情况下每个粒子是被渲染成一个小方块的。</p> <p><code>Sprite</code>适用于少量粒子的情况，每个粒子都是一个实例进行单独管理，且每个粒子可单独设置材质；而<code>Points</code>适用于绘制大量粒子的情况，且其代表粒子云整体，所以其中的所有粒子也都是同一种材质(但可可改变每个顶点的颜色)。</p> <h2 id="_7-1-理解粒子"><a href="#_7-1-理解粒子" class="header-anchor">#</a> 7.1 理解粒子</h2> <p>粒子实际就是一些细小的物体(并非一定是个点，但可以看做是一个点)，大量粒子就可以形成一个新的物体的轮廓。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用`THREE.Sprite`创建一个30*20的精灵(粒子)网</span>
<span class="token keyword">function</span> <span class="token function">createSprites</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x<span class="token operator">=</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">;</span>x<span class="token operator">&lt;</span><span class="token number">15</span><span class="token punctuation">;</span>x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> y<span class="token operator">=</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">;</span>y<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpriteMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        color<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xffffff</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 参数材质只能是`THREE.SpriteMaterial`或`THREE.SpriteCanvasMaterial`</span>
      <span class="token comment">// `THREE.Sprite`与`THREE.Mesh`一样，都是`THREE.Object3D`对象的扩展，所以其也可以使用`THREE.Mesh`的大部分属性和函数</span>
      <span class="token keyword">const</span> sprite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>material<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 每个点都要创建一个`THREE.Sprite`对象，太多会出现性能问题，所以一般用于少量粒子</span>
      sprite<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>x<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span> y<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sprite<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用`THREE.Points`创建同样的一个30*20的粒子网</span>
<span class="token keyword">function</span> <span class="token function">createPoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> geom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Geometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 创建一个几何体对象</span>
  <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PointsMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment">// 定义粒子材质</span>
    sieze<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    vertexColors<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>VertexColors<span class="token punctuation">,</span> <span class="token comment">// 即设为true，表示使用顶点着色</span>
    color<span class="token operator">:</span> <span class="token number">0xffffff</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x<span class="token operator">=</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">;</span>x<span class="token operator">&lt;</span><span class="token number">15</span><span class="token punctuation">;</span>x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 为每个粒子创建一个顶点</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> y<span class="token operator">=</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">;</span>y<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> particle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>x<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span> y<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 定义粒子顶点</span>
      geom<span class="token punctuation">.</span>vertices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>particle<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将顶点放进几何体的顶点组中</span>
      geom<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xffffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置各顶点颜色</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> pointsCloud <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Points</span><span class="token punctuation">(</span>gemo<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 一次性创建粒子云</span>
    scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>pointsCloud<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_7-2-three-points和three-pointsmaterial"><a href="#_7-2-three-points和three-pointsmaterial" class="header-anchor">#</a> 7.2 <code>THREE.Points</code>和<code>THREE.PointsMaterial</code></h2> <p><code>THREE.Points</code>方法接收两个参数：几何体和材质。材质用来给粒子着色和添加纹理，而几何体则用来指定单个粒子的位置。每个用来定义几何体的顶点，都将会以粒子的形态展示出来。若我们直接使用Three.js内置的标准几何体(声明好几何体时就相当于确定好了顶点)来创建<code>THREE.Points</code>，则这些几何体的顶点将以粒子态展示(不需要手动设置顶点)，但一般都不使用内置的标准几何体创建粒子(因为图形太简单没意义)。通常都是从零开始手动将顶点添加到几何体上(<code>THREE.Geometry</code>)，或者使用一个外部加载的模型。<code>THREE.Points</code>创建粒子云的示例见上面7.1节。注意，<strong>默认情况下粒子是被渲染成一个小方块的</strong>，而不真是一个点。<code>THREE.Points</code>中所有粒子都应用的是同一个材质，不能单独对每个粒子应用不同的材质，但可以提供几何体的顶点颜色数组来设置每个顶点的颜色进行着色。</p> <p><code>THREE.PointsMaterial</code>用于设置粒子的材质，其包含的配置项说明如下：
<img src="/assets/img/THREE.PointsMaterial.65e14bc1.jpg" alt="THREE.PointsMaterial的参数"></p> <h2 class="color-danger">============== 以下开始笔记只是简单记录，快速浏览一遍书本内容 ==============</h2> <h2 id="_7-3-使用h5-canvas画布样式化粒子"><a href="#_7-3-使用h5-canvas画布样式化粒子" class="header-anchor">#</a> 7.3 使用H5-Canvas画布样式化粒子</h2> <p>有三种方式使用H5-Canvas画布来样式话粒子，<code>CanvasRenderer</code>渲染器中可以通过<code>SpriteCanvasMaterial</code>引用画布，<code>WebGLRenderer</code>渲染器需要使用材质贴图纹理的方式间接使用canvas画布。</p> <h3 id="_7-3-1-在canvasrenderer中使用html5画布"><a href="#_7-3-1-在canvasrenderer中使用html5画布" class="header-anchor">#</a> 7.3.1 在<code>CanvasRenderer</code>中使用HTML5画布</h3> <p>通过<code>THREE.SpriteCanvasMaterial</code>，将canvas画布的输出结果作为粒子的纹理</p> <h3 id="_7-3-2-在webglrenderer中使用html5画布"><a href="#_7-3-2-在webglrenderer中使用html5画布" class="header-anchor">#</a> 7.3.2 在<code>WebGLRenderer</code>中使用HTML5画布</h3> <p>两种方法，可以使用<code>THREE.Points</code>和<code>THREE.PointsMaterial</code>的<code>map</code>属性，或者可以使用<code>THREE.Sprite</code>和<code>THREE.SpriteMaterial</code>的<code>map</code>属性。<code>map</code>可以映射一个贴图纹理<code>THREE.Texture</code>，而该贴图纹理的来源不仅可以是普通图片，也可以是canvas画布。</p> <p>大量粒子可能会造成一些粒子重叠，有时会有错误的透明效果出现，为避免该情况出现，需要手动设置每个粒子的层级，使得后来居上，比如生成粒子时每次将<code>z</code>坐标增加一点点。</p> <h2 id="_7-4-使用纹理样式化粒子"><a href="#_7-4-使用纹理样式化粒子" class="header-anchor">#</a> 7.4 使用纹理样式化粒子</h2> <p>使用图片样式化粒子时可以直接使用<code>THREE.TextureLoader().load()</code>将图像加载为<code>THREE.Texture</code>对象，然后就可以将该纹理对象分配给材质的map属性。若图片带有背景色而不是使用的透明图片，可以将材质选项中融合模式<code>blending</code>设为<code>THREE.AdditiveBlending</code>。</p> <h2 id="_7-5-使用精灵贴图"><a href="#_7-5-使用精灵贴图" class="header-anchor">#</a> 7.5 使用精灵贴图</h2> <p>精灵贴图指将多个图形放在一张图片上，根据需要显示不同的部分，同CSS中背景图标和JS帧动画一样。可以通过<code>mtl.map.offset</code>和<code>mtl.map.repeat</code>两个属性设置贴图的偏移量和重复率，这些属性是按照贴图大小比例计算的，不是绝对距离，所以每个方向上的取值都是(0,1)之间。</p> <h2 id="_7-6-从高级几何体创建three-points"><a href="#_7-6-从高级几何体创建three-points" class="header-anchor">#</a> 7.6 从高级几何体创建<code>THREE.Points</code></h2> <p>如前面可知<code>THREE.Points</code>基于几何体的顶点来渲染每个粒子，前面我们使用顶点自定义构建出几何体，我们也可以直接使用一个已有的复杂几何体的顶点去创建出<code>THREE.Points</code>对象。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/draw-animation/Threejs开发指南/第6章.html" class="prev">
        第6章 高级几何体和二元操作
      </a></span> <span class="next"><a href="/draw-animation/Threejs开发指南/第8章.html">
        第8章 创建/加载高级网格和几何体
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.377ebb8d.js" defer></script><script src="/assets/js/2.3ff17b28.js" defer></script><script src="/assets/js/13.49d0da8a.js" defer></script>
  </body>
</html>
