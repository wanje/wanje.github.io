(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{453:function(t,s,a){"use strict";a.r(s);var n=a(18),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"第9章-创建动画和移动摄像机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第9章-创建动画和移动摄像机"}},[t._v("#")]),t._v(" 第9章 创建动画和移动摄像机")]),t._v(" "),a("p",[t._v("目录\n")]),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#_9-1-基础动画"}},[t._v("9.1 基础动画")]),a("ul",[a("li",[a("a",{attrs:{href:"#_9-1-1-简单动画"}},[t._v("9.1.1 简单动画")])]),a("li",[a("a",{attrs:{href:"#_9-1-2-选择对象"}},[t._v("9.1.2 选择对象")])]),a("li",[a("a",{attrs:{href:"#_9-1-3-使用-tween-js-实现动画"}},[t._v("9.1.3 使用Tween.js实现动画")])])])]),a("li",[a("a",{attrs:{href:"#_9-2-使用摄像机"}},[t._v("9.2 使用摄像机")]),a("ul",[a("li",[a("a",{attrs:{href:"#_9-2-1-轨迹球控制器-trackballcontrols"}},[t._v("9.2.1 轨迹球控制器TrackballControls")])]),a("li",[a("a",{attrs:{href:"#_9-2-2-飞行控制器-flycontrols"}},[t._v("9.2.2 飞行控制器FlyControls")])]),a("li",[a("a",{attrs:{href:"#_9-2-3-第一视角控制器-firstpersoncontrols"}},[t._v("9.2.3 第一视角控制器FirstPersonControls")])]),a("li",[a("a",{attrs:{href:"#_9-2-4-轨道控制器-orbitcontrols"}},[t._v("9.2.4 轨道控制器OrbitControls")])])])]),a("li",[a("a",{attrs:{href:"#_9-3-变形动画和骨骼动画"}},[t._v("9.3 变形动画和骨骼动画")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"_9-1-基础动画"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-基础动画"}},[t._v("#")]),t._v(" 9.1 基础动画")]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("requestAnimationFrame()")]),t._v("方法循环调用render渲染函数来实现动画(循环函数中包含每次调用时对动画属性值的更改)。")]),t._v(" "),a("h3",{attrs:{id:"_9-1-1-简单动画"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-1-简单动画"}},[t._v("#")]),t._v(" 9.1.1 简单动画")]),t._v(" "),a("p",[t._v("可以通过改变物体的旋转、缩放、位置、材质、顶点、面以及其他所能想拿到的属性来实现动画。")]),t._v(" "),a("h3",{attrs:{id:"_9-1-2-选择对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-2-选择对象"}},[t._v("#")]),t._v(" 9.1.2 选择对象")]),t._v(" "),a("p",[t._v("这里选择对象也就是第一章中提到的处理鼠标事件判断鼠标是否选中相应对象的问题，这里采用第一章中"),a("strong",[t._v("屏幕二维坐标转换为三维坐标")]),t._v("的方法加发射光线来检测选中的物体：")]),t._v(" "),a("ul",[a("li",[t._v("首先，基于屏幕上的点击位置(归一化)创建一个"),a("code",[t._v("THREE.Vector3")]),t._v("向量；")]),t._v(" "),a("li",[t._v("接着，使用"),a("code",[t._v("vector.unproject")]),t._v("方法将屏幕上的归一化的点击坐标转换为三维场景中的坐标；")]),t._v(" "),a("li",[t._v("然后，使用"),a("code",[t._v("THREE.Raycaster")]),t._v("创建一束从摄像机位置到场景中鼠标点击方向的投射光线；")]),t._v(" "),a("li",[t._v("最后，使用"),a("code",[t._v("raycaster.intersectObjects")]),t._v("方法判断指定对象集合中哪些对象被该光线照射到了，而返回的第一个照射到的对象就是点击到的最前面的网格对象")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleClick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 归一化画布坐标")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" x "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetX "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" renderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clientWidth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" y "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetY "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" renderer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clientHeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vector "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Vector3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  vector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unproject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("camera"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将归一化坐标投射到三维空间坐标中")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建光线投射，第一个参数表示光线发射起点位置、第二个参数为一个方向向量表示光线的发射方向")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" raycaster "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Raycaster")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("camera"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("positon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sub")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("camera"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("positon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("normalize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 检测光线穿过那些物体，第一个参数为要检测的对象集合，可选第二个布尔参数表示是否检测物体的后代对象(默认false)，返回一个数组")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" intersectObjects "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" raycaster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("intersectObjects")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("scene"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断点击到的物体是否是我们的目标物体")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intersectObjects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intersectObjects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'targetName'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("intersectObjects数组中的每个网格对象都包含如下一些信息，其中\n        ‘distance’表示摄像机到被点击对象的具体，\n        ‘face’和‘faceIndex’表示该网格中被选中的面及该面在所有面中的索引位置，\n        ‘point’表示网格上那个点被点击了，\n        ‘uv’表示点击位置所对应的2D纹理的uv值，\n        ‘object’则为该点中网格的mesh对象\n      ")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'点击到了目标物体'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" intersectObjects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_9-1-3-使用tween-js实现动画"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-3-使用tween-js实现动画"}},[t._v("#")]),t._v(" 9.1.3 使用"),a("code",[t._v("Tween.js")]),t._v("实现动画")]),t._v(" "),a("p",[a("code",[t._v("Tween.js")]),t._v("是一个轻量级的JS补间动画库。")]),t._v(" "),a("h2",{attrs:{id:"_9-2-使用摄像机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-使用摄像机"}},[t._v("#")]),t._v(" 9.2 使用摄像机")]),t._v(" "),a("h3",{attrs:{id:"_9-2-1-轨迹球控制器trackballcontrols"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-1-轨迹球控制器trackballcontrols"}},[t._v("#")]),t._v(" 9.2.1 轨迹球控制器"),a("code",[t._v("TrackballControls")])]),t._v(" "),a("h3",{attrs:{id:"_9-2-2-飞行控制器flycontrols"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-2-飞行控制器flycontrols"}},[t._v("#")]),t._v(" 9.2.2 飞行控制器"),a("code",[t._v("FlyControls")])]),t._v(" "),a("h3",{attrs:{id:"_9-2-3-第一视角控制器firstpersoncontrols"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-3-第一视角控制器firstpersoncontrols"}},[t._v("#")]),t._v(" 9.2.3 第一视角控制器"),a("code",[t._v("FirstPersonControls")])]),t._v(" "),a("h3",{attrs:{id:"_9-2-4-轨道控制器orbitcontrols"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-4-轨道控制器orbitcontrols"}},[t._v("#")]),t._v(" 9.2.4 轨道控制器"),a("code",[t._v("OrbitControls")])]),t._v(" "),a("h2",{attrs:{id:"_9-3-变形动画和骨骼动画"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-变形动画和骨骼动画"}},[t._v("#")]),t._v(" 9.3 变形动画和骨骼动画")])])}),[],!1,null,null,null);s.default=e.exports}}]);