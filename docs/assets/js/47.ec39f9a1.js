(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{476:function(t,s,a){"use strict";a.r(s);var n=a(18),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"nginx基础配置与操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx基础配置与操作"}},[t._v("#")]),t._v(" Nginx基础配置与操作")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#nginx常用命令"}},[t._v("nginx常用命令")]),a("ul",[a("li",[a("a",{attrs:{href:"#信息查看"}},[t._v("信息查看")])]),a("li",[a("a",{attrs:{href:"#启停操作"}},[t._v("启停操作")])]),a("li",[a("a",{attrs:{href:"#其他命令"}},[t._v("其他命令")])]),a("li",[a("a",{attrs:{href:"#日志信息"}},[t._v("日志信息")])]),a("li",[a("a",{attrs:{href:"#通用文本文件编辑保存命令"}},[t._v("通用文本文件编辑保存命令")])])])]),a("li",[a("a",{attrs:{href:"#nginx-conf-基础配置"}},[t._v("nginx.conf 基础配置")])]),a("li",[a("a",{attrs:{href:"#参考学习资料"}},[t._v("参考学习资料")])])])]),a("p"),t._v(" "),a("p",[t._v("大多情况下配置文件在"),a("code",[t._v("conf")]),t._v("目录下，执行指令为"),a("code",[t._v("sbin")]),t._v("目录下的"),a("code",[t._v("nginx")]),t._v("脚本文件。")]),t._v(" "),a("h2",{attrs:{id:"nginx常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx常用命令"}},[t._v("#")]),t._v(" nginx常用命令")]),t._v(" "),a("h3",{attrs:{id:"信息查看"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#信息查看"}},[t._v("#")]),t._v(" 信息查看")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 nginx 主程序（可执行文件）所在路径，如 /usr/sbin/nginx")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" nginx \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("whereis")]),t._v(" nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该命令实际为检查配置文件语法，同时可查看 nginx 配置文件所在路径，如 /etc/nginx/nginx.conf")]),t._v("\nnginx -t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出类似 nginx: using configuration file /etc/nginx/nginx.conf")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或")]),t._v("\nnginx -V "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" -- "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'--conf-path'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 会显示编译参数，其中 --conf-path=... 就是默认配置文件路径")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进程查看")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" nginx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看nginx的进程号，其中输出的master为主进程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" aux "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" nginx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以看到 nginx 主进程和 worker 进程的路径")]),t._v("\n")])])]),a("h3",{attrs:{id:"启停操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启停操作"}},[t._v("#")]),t._v(" 启停操作")]),t._v(" "),a("p",[t._v("进入"),a("code",[t._v("sbin")]),t._v("目录下进行如下操作指令，此时前面的"),a("code",[t._v("./nginx")]),t._v("或直接"),a("code",[t._v("nginx")]),t._v("就是"),a("code",[t._v("sbin")]),t._v("下的"),a("code",[t._v("nginx")]),t._v("脚本文件（或在其他目录下通过相对路径指向该nginx可执行文件）：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("nginx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动nginx，默认conf/nginx.conf文件作为配置文件")]),t._v("\n\nnginx -c conf_file "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以配置文件conf_file的配置内容启动，conf_file为配置文件的绝对路径")]),t._v("\n\nnginx -s reload "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 平滑的重启，在修改完配置后重新加载配置文件时非常有用")]),t._v("\n\nnginx -s stop "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 直接关闭停止nginx")]),t._v("\n\nnginx -s quit "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 有序退出停止，其会等所有请求结束后关闭nginx，比直接stop更平滑")]),t._v("\n")])])]),a("h3",{attrs:{id:"其他命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他命令"}},[t._v("#")]),t._v(" 其他命令")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("nginx -t "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检测默认配置文件是否有语法错误，其同时会输出所用配置文件所在位置")]),t._v("\n\nnginx -t -c conf_file "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检测配置文件conf_file是否有语法错误，conf_file为配置文件的绝对路径")]),t._v("\n")])])]),a("h3",{attrs:{id:"日志信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#日志信息"}},[t._v("#")]),t._v(" 日志信息")]),t._v(" "),a("p",[t._v("通过查看 nginx 的访问日志或错误日志可以排查部分配置解析问题。访问日志文件为"),a("code",[t._v("access.log")]),t._v("，错误日志文件为"),a("code",[t._v("error.log")]),t._v("，它们的保存位置默认一般为"),a("code",[t._v("/var/log/nginx/access.log")]),t._v("或同安装目录下"),a("code",[t._v("logs/access.log")]),t._v("。")]),t._v(" "),a("p",[t._v("可用"),a("code",[t._v("tail -f")]),t._v("命令实时查看日志内容：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 后面参数为日志文件所在路径")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tail")]),t._v(" -f /var/log/nginx/access.log\n")])])]),a("p",[t._v("上面的日志文件存放位置、内容格式、作用范围都可以在配置文件中进行自定义，访问日志使用"),a("code",[t._v("access_log")]),t._v("字段设置，错误日志使用"),a("code",[t._v("error_log")]),t._v("字段设置，相应字段可设置在配置文件最外层，也可以在"),a("code",[t._v("http")]),t._v("、"),a("code",[t._v("server")]),t._v("、"),a("code",[t._v("location")]),t._v("等块中，内层设置可覆盖外层设置，类似 CSS 元素选择器的嵌套层级关系。")]),t._v(" "),a("p",[t._v("访问日志的设置语法为："),a("code",[t._v("access_log <path> [format [buffer=size] [if=condition]]")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("access_log")]),t._v(" 为设置的日志类型，此为访问日志，错误日志则用"),a("code",[t._v("error_log")])]),t._v(" "),a("li",[a("code",[t._v("<path>")]),t._v(" 为日志文件路径，如"),a("code",[t._v("/var/log/nginx/access.log")])]),t._v(" "),a("li",[a("code",[t._v("[format [buffer=size] [if=condition]]")]),t._v(" 为可选字段，指定日志格式和记录条件\n"),a("ul",[a("li",[a("code",[t._v("format")]),t._v(" 为日志格式名，如"),a("code",[t._v("main")]),t._v("，该对应的格式需要使用"),a("code",[t._v("log_format")]),t._v("字段预先定义好")]),t._v(" "),a("li",[a("code",[t._v("buffer")]),t._v(" 为缓冲区大小，指定为"),a("code",[t._v("buffer=16k")]),t._v("，日志先写入缓存区，满后在写入磁盘")]),t._v(" "),a("li",[a("code",[t._v("if")]),t._v(" 为日志记录条件，如"),a("code",[t._v("if=$status=404")]),t._v("，表示只记录404状态的请求")])])])]),t._v(" "),a("p",[t._v("错误日志的设置语法为："),a("code",[t._v("error_log <path> [level]")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("path")]),t._v(" 为错误日志文件路径")]),t._v(" "),a("li",[a("code",[t._v("level")]),t._v(" 为错误日志级别，可选，默认"),a("code",[t._v("error")]),t._v("，支持的级别有"),a("code",[t._v("debug")]),t._v("、"),a("code",[t._v("info")]),t._v("、"),a("code",[t._v("notice")]),t._v("、"),a("code",[t._v("warn")]),t._v("、"),a("code",[t._v("error")]),t._v("、"),a("code",[t._v("crit")]),t._v("、"),a("code",[t._v("alert")]),t._v("、"),a("code",[t._v("emerg")])])]),t._v(" "),a("p",[t._v("日志格式定义语法为："),a("code",[t._v("log_format <name> <format_string>")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("name")]),t._v(" 为日志格式名")]),t._v(" "),a("li",[a("code",[t._v("format_string")]),t._v(" 为具体的日志内容格式字符串，其中支持访问 nginx 内置变量如："),a("code",[t._v('$remote_addr - $remote_user [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent"')])])]),t._v(" "),a("p",[a("strong",[t._v("日志文件会不断增长，故建议用 logrotate 工具定期切割。")])]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最外层日志配置，适用于全局")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("access_log")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("log_format")]),t._v("  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$remote_addr - $remote_user [$time_local] \"$request\" '")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'$status $body_bytes_sent \"$http_referer\" '")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'"$http_user_agent" "$http_x_forwarded_for"\'')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("access_log")]),t._v("  logs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("access"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log  main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("access_log")]),t._v(" off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭当前匹配路径下的访问日志")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"通用文本文件编辑保存命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通用文本文件编辑保存命令"}},[t._v("#")]),t._v(" 通用文本文件编辑保存命令")]),t._v(" "),a("p",[t._v("在Linux下命令行中常用的文本编辑工具(或命令)为"),a("code",[t._v("vim")]),t._v("、"),a("code",[t._v("nano")]),t._v("、"),a("code",[t._v("vi")]),t._v("，其中"),a("code",[t._v("vim")]),t._v("是"),a("code",[t._v("vi")]),t._v("的增强版，系统中一般都预装了"),a("code",[t._v("vi")]),t._v("或"),a("code",[t._v("vim")]),t._v("，可优先使用"),a("code",[t._v("vim")]),t._v("。")]),t._v(" "),a("p",[t._v("使用上面命令打开文件编辑完成，按"),a("code",[t._v(":wq")]),t._v("(vim/vi)保存并退出，按"),a("code",[t._v(":q!")]),t._v("退出但不保存。")]),t._v(" "),a("p",[t._v("若仅是查看文件内容，不编辑，可使用"),a("code",[t._v("cat")]),t._v("命令查看。")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打开文件，file_path 指具体的要编辑文件路径，如：/etc/nginx/nginx.conf，也可用相对路径")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" file_path\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" file_path\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 按 i 可进行插入编辑")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编辑完成后按`:wq`(vim/vi)保存并退出")]),t._v("\n")])])]),a("p",[a("code",[t._v("vim")]),t._v("或"),a("code",[t._v("vi")]),t._v("打开文件后，可进行如下输入/快捷操作：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("i")]),t._v(" 进入插入模式（开始编辑）")]),t._v(" "),a("li",[a("code",[t._v("Esc")]),t._v(" 退出插入模式，回到命令模式")]),t._v(" "),a("li",[a("code",[t._v(":w")]),t._v(" 保存")]),t._v(" "),a("li",[a("code",[t._v(":q")]),t._v(" 退出")]),t._v(" "),a("li",[a("code",[t._v(":wq")]),t._v("或"),a("code",[t._v("zz")]),t._v(" 保存并退出")]),t._v(" "),a("li",[a("code",[t._v(":q!")]),t._v(" 强制退出不保存")]),t._v(" "),a("li",[a("code",[t._v("/关键字")]),t._v(" 向下搜索关键字")]),t._v(" "),a("li",[a("code",[t._v("?关键字")]),t._v(" 向上搜索关键字")]),t._v(" "),a("li",[a("code",[t._v("dd")]),t._v(" 删除当前行")]),t._v(" "),a("li",[a("code",[t._v("yy")]),t._v(" 复制当前行")]),t._v(" "),a("li",[a("code",[t._v("p")]),t._v(" 粘贴")]),t._v(" "),a("li",[a("code",[t._v("u")]),t._v(" 撤销")]),t._v(" "),a("li",[a("code",[t._v("Ctrl+r")]),t._v(" 重做")])]),t._v(" "),a("h2",{attrs:{id:"nginx-conf-基础配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-conf-基础配置"}},[t._v("#")]),t._v(" nginx.conf 基础配置")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#load_module "modules/ngx_http_image_filter_module.so";')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#load_module "modules/ngx_http_perl_module.so";')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#load_module "modules/ngx_http_xslt_filter_module.so";')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#load_module "modules/ngx_mail_module.so";')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#load_module "modules/ngx_stream_module.so";')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# user                         nobody staff;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_processes")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("events")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("worker_connections")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# http 协议的配置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),t._v("               mime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("types")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里是引入了外部单独的 mime.types 文件的内容插入该位置（设置了types字段对应相关文件的mime类型）")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default_type")]),t._v("          text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 默认文件类型")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("client_max_body_size")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 客户端最大提交内容大小，主要影响文件上传")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip")]),t._v("                  on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开启 gzip 静态资源压缩，下面 gzip_types 为要压缩的文件 mime 类型")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("gzip_types")]),t._v("            text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("css text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("component application"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("javascript application"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("javascript text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("javascript text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("js text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("richtext image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("svg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("xml text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("plain text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xsd text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xsl text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xml image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("icon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sendfile")]),t._v("              on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 服务端口监听，可以设置多个监听不同端口")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8888")]),t._v(" default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 监听端口，default_server 表示此端口设为默认端口")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 拦截的访问IP，也可设为 localhost")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("                 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Users"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("computerName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Desktop"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该端口指向的根目录位置")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 路由匹配，可设置多个")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里注意'/path'既能匹配'/path/x'，也能匹配'/pathx'，而'/path/'只能匹配'/path/x'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# proxy_set_header Host $host:9999; # 设置响应头部？")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("https")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("finance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pae"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baidu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将匹配路径代理到的实际路径，可以是在线地址，也可以是本地文件/服务地址，proxy_pass地址后面带上'/'则会减去location匹配的部分进行拼接，否则会直接拼接在后面")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 不设置则默认全量？若有设置部分不在里面的文件类型可能加载不出来")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 正则匹配(带~)，忽略大小写，并匹配以指定字符结尾的请求（这里为文件类型）")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" \\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("css"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("flash"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("media"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("jpg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("png"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("dll"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("svg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("cab"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("CAB"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ico"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("woff"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("woff2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ttf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("json"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mp4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("mp3"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("zip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("root_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("expires")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 失效时长？")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# location ^~ /static/：优先匹配 /static/ 开头的路径")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vue/react history 路由模式配置示例")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("busiMonitorSys "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Users"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("computerName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Desktop"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("demo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dist"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 与 server 中的可以不一样，这个为局部，优先级更高")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# root 与 alias 字段的区别是，root 是拼接 location 匹配的 url，而 alias 是替换 location 匹配的部分（而非url）")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当访问到一个目录时，默认将其指向其中的哪个实际文件（按顺序查找列举的可能文件）")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dist"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关键配置，使得支持history模式")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# try_files $uri $uri.html $uri/ /index.html # 当SSG与SPA路由混合使用时")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关键字 $uri 表示访问时匹配到的完整路径")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# try_files 这里表示若有找到 $uri 指向的文件则返回对应文件内容，否则返回 $uri/ 下上面 index 字段设置的可能文件，若还是未找到，则返回最后设置的文件内容")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 服务器将vue/react history路由按常规文件路由的方式查找一般是找不到对应文件的，所以匹配到try_files这里最后指定的文件")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# 这里让其返回前端工程打包后的入口文件index.html的内容(实际路径根据自己的部署位置修改，如这里前面加了"/dist"则表示是部署在根路径下dist子目录的，通常是部署在根路径下的就直接"/index.html")，注意返回的是内容而不是重定向浏览器中的访问路径，故内容正确且路由无异常就可使得JS中的router按照history模式正确解析')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 同一目录下要匹配多个部署应用可使用正则匹配，如这里 docs 目下下部署了多个文档应用")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("docs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$subdoc")]),t._v(" $"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定义变量，将上面正则捕获的第一个括号内容$1 赋给自定义变量 $subdoc")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("to"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("docs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$subdoc")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最后的文件用于兜底，避免都找不到而404")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里 try_files 若不设置最后的兜底文件，则访问 /docs/xxx/ 可能会500错误，由于路径后有`/`其会先找`/docs/xxx/index.html`若不存在最后由于设置的`$uri/`，其会一直追加`/`导致死循环`/docs/xxx/////...`")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTPS server")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"参考学习资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考学习资料"}},[t._v("#")]),t._v(" 参考学习资料")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/tC5EF-vhiBrjXlTQLuXRhw",target:"_blank",rel:"noopener noreferrer"}},[t._v("三年前端还不会配置Nginx，今天一口气学完"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/81gLHxXK0P-si2WCzgQKOg",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx 常用的基础配置（高级前端须知）"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/BA_JZ_kMBFZBE7jjQDNc1Q",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端开发者必备的 Nginx 知识"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6844903701459501070",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端必会的 Nginx入门视频教程(共11集)-技术胖"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.digitalocean.com/community/tools/nginx?global.app.lang=zhCN",target:"_blank",rel:"noopener noreferrer"}},[t._v("NGINXConfig-nginx在线配置工具"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);