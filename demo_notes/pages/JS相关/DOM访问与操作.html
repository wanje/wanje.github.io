<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DOM访问与操作</title>
    <link rel="stylesheet" href="../../plugins/highlight/styles/androidstudio.css">
    <script src="../../plugins/highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <style type="text/css">
        body,pre {margin: 0;}
        .code {display: block;white-space: pre;font-family: monospace;}
    </style>
</head>
<body>
<pre><code class="css">

    /*=================================================================================================================*/
    /*==================================================== DOM访问 ====================================================*/
    /*=================================================================================================================*/
    DOM中节点Node类型总共有12种，这些节点类型定义在12个数值常量中，我们最常用的有两种：Node.ELEMENT_NODE（元素节点，等于1）、Node.TEXT_NODE（文本节点，等于3）
    Node.ELEMENT_NODE === 1
    Node.TEXT_NODE === 3
    由于IE中并未规范定义这些常量，所以为保证兼容性，在判断节点类型时应与数字值进行比较，这是所有浏览器都支持的。

    注意名词区分：
    tagName标签名指HTML元素的语法标签，如：div、p、span、img等；
    name元素名指HTML元素的上name属性值，表示该元素是命名元素，如：&lt;img src="a.jpg" name="myImg"/>的元素名为myImg，而标签名为img；

    NodeList对象表示一个节点集，其为类数组，也可转换为真数组：Array.prototype.slice.call(NodeList)
    NodeList可以通过length属性获取其长度，如：node.childNodes.length
    有两种方式可以访问NodeList中的节点项：
    1、因为为类数组，所以可以通过方括号加索引的方式访问：node.childNodes[0]
    2、使用item()方法传入索引访问：node.childNodes.item(0)

    HTMLCollection对象表示一个元素集，其与NodeList类似，也为类数组，具有length属性，可通过方括号语法[]和item()方法访问其中的项
    额外说明，对于命名元素(即由设置了name属性的元素，如：&lt;img src="a.jpg" name="myImg"/>)：
    1、HTMLCollection对象还可通过namedItem()方法访问其中的项，传入属性的name值：document.getElementsByTagName('img').namedItem('myImg')，有多个相同name元素时则只返回第一项
    2、方括号语法中也可通过传入name属性的值来访问：document.getElementsByTagName('img')['myImg']
    3、对于HTMLCollection对象而言，使用方括号语法[]时可传入数值或字符串形式的索引值。在后台，对数值索引会调用item()方法，对字符串索引会调用namedItem()方法，这也就解释了为什么第2条中传入name属性值也能访问了
    4、在各浏览器中实测发现：上面两种字符串访问方式虽然是针对name属性的，但对id属性也同样有效，其会先根据name属性查询，若未匹配到就会根据id属性查询，都未匹配到则返回null

    HTMLCollection对象与NodeList对象的区别是：
    HTMLCollection为使用DOM提供的‘方法’根据相关特征‘查询’得到的元素(集)，如：根据id、name、tagName、class等查询到的
    而NodeList为通过DOM节点提供的‘属性’获得的与当前节点有位置联系的节点(集)，如：根据父子关系、前后关系等获得的


    以下属性可访问到当前node节点的一些关系节点，注意它们都是只读的：
    ----------------------|---------------------------------------------------------------------------------------------
    node.nodeType         |   ‘nodeType’属性表明节点Node类型
    ----------------------|---------------------------------------------------------------------------------------------
    node.nodeName         |   ‘nodeName’属性表明节点的名字，对于元素节点，始终是元素的标签名
    ----------------------|---------------------------------------------------------------------------------------------
    node.nodeValue        |   ‘nodeValue’属性表明节点的文本值，文本节点即就是文本内容，而元素节点该属性值始终为null
    ----------------------|---------------------------------------------------------------------------------------------
    node.childNodes       |   ‘childNodes’属性(复数)的值为一个NodeList对象(类数组)，保存的是该节点的所有子节点(非所有后代)；
                          |   NodeList对象独特之处在于其值是动态查询的结果，也就每次访问时其都是返回访问时刻的节点情况，而不是最初的快照；
    ----------------------|---------------------------------------------------------------------------------------------
    node.children         |   ‘children’属性的值为一个HTMLCollection对象(类数组)，保存的是该节点下的所有子元素节点；
                          |   注意是“子元素”而不是子节点，这是与childNodes最大的不同（IE8下会包含注释节点）
    ----------------------|---------------------------------------------------------------------------------------------
    node.firstChild       |   ‘firstChild’属性指向该节点的第一个子节点，同childNodes[0]，注意是子节点，并非一定是元素节点(IE下是元素节点)
    ----------------------|---------------------------------------------------------------------------------------------
    node.firstElementChild|   ‘firstElementChild’属性指向该节点的第一个子元素节点，IE9+支持(IE可以用firstChild)
    ----------------------|---------------------------------------------------------------------------------------------
    node.lastChild        |   ‘lastChild’属性指向该节点的最后一个子节点，同childNodes[childNodes.length-1]
    ----------------------|---------------------------------------------------------------------------------------------
    node.firstElementChild|   ‘firstElementChild’属性指向该节点的最后一个子元素节点，类似上面`firstElementChild`
    ----------------------|---------------------------------------------------------------------------------------------
    node.parentNode       |   ‘parentNode’属性(单数)指向该节点的父节点(非所有祖先)
    ----------------------|---------------------------------------------------------------------------------------------
    node.previousSibling  |   ‘previousSibling’属性(单数)指向该节点相邻的前面一个兄弟节点，若前面无兄弟节点，则该值为null
    ----------------------|---------------------------------------------------------------------------------------------
    node.nextSibling      |   ‘nextSibling’属性(单数)指向该节点相邻的后面一个兄弟节点，若后面无兄弟节点，则该值为null
    ----------------------|---------------------------------------------------------------------------------------------
    node.ownerDocument    |   ‘ownerDocument’属性指向该节点所在的文档节点，即document，每个节点只能同时存在一个文档中
    ======================|=============================================================================================
    node.hasChildNodes()  |   hasChildNodes()方法判断该节点是否有子节点，返回布尔值；该方法比去检查childNodes的length更简单
    ----------------------|---------------------------------------------------------------------------------------------


    /*================================================================================================================*/
    /*==================================================== DOM操作 ====================================================*/
    /*================================================================================================================*/

    -------------------------------------|------------------------------------------------------------------------------
    node.appendChild(newNode)            |   该方法表示在当前node节点中插入一个新子节点newNode，即在node节点的childNodes列表后再添加一个节点；
                                         |   若插入的newNode节点原本就是文档中已存在的节点，该操作则是对newNode节点位置的转移，即剪切插入而不是复制插入；
                                         |   其会return新增的newNode节点；
    -------------------------------------|------------------------------------------------------------------------------
    node.append(newNodes|string)         |   IE不支持，该方法可在node节点中后面插入一组新的子节点或字符串(会当做普通文本)，且其没有返回值；
                                         |   插入一组及多个时，用逗号隔开当做多个参数分别传入，且node和string可混合插入；
    -------------------------------------|------------------------------------------------------------------------------
    node.insertBefore(newNode,baseNode)  |   该方法表示在node节点内参照节点baseNode前面插入一个新兄弟节点newNode，若参照节点baseNode为null，则该方法的作用与appendChild()方法相同；
                                         |   其会return新插入的newNode节点
    -------------------------------------|------------------------------------------------------------------------------
    node.insertAdjacentHTML(pos,htmlStr) |   该方法表示在node节点pos位置插入html字符串htmlStr，pos有4个值可选(字符串)：beforebegin(元素外部的前面)、afterbegin(元素内部的前面)、beforeend(元素内部的后面)、afterend(元素外部的后面)；
                                         |   IE10+全支持，IE9- 部分支持且不能用于table系列元素
                                         |   该方法会对插入的内容进行html解析转换，若只是插入纯文本，则建议使用 node.textContent 属性或 node.insertAdjacentText() 方法以提高性能
    -------------------------------------|------------------------------------------------------------------------------
    node.insertAdjacentElement(pos,el)   |   用法同上，只是该方法第二个参数为DOM元素对象
    -------------------------------------|------------------------------------------------------------------------------
    node.insertAdjacentText(pos,str)     |   用法同上，只是该方法是作为文本插入，不会进行html解析
    -------------------------------------|------------------------------------------------------------------------------
    node.replaceChild(newNode,oldNode)   |   该方法表示在node节点内用新节点newNode替换原子节点oldNode，被替换的oldNode节点会被从文档中移除；
                                         |   其会return被替换的oldNode子节点
    -------------------------------------|------------------------------------------------------------------------------
    node.removeChild(aChildNode)         |   该方法表示从文档中移除node节点的一个aChildNode子节点；
                                         |   其会return被移除的aChildNode子节点
    -------------------------------------|------------------------------------------------------------------------------
    node.cloneNode(isDeep)               |   该方法用于拷贝node节点的一个副本，参数isDeep为布尔值，表示是否深度拷贝，为true则会拷贝节点内部所有节点树，为false则只拷贝node节点本身而不拷贝内部；
                                         |   注意：1、拷贝出的副本虽属于文档所有，但是并未放在文档中，只有插入了文档中才会在文档中实际存在（类似我们已create但还未插入文档中的节点）
                                         |        2、该方法不会拷贝添加在节点上的JS属性，如事件处理程序等，只会拷贝HTML所有结构和属性
    -------------------------------------|------------------------------------------------------------------------------
    node.normalize()                     |   该方法用于处理文档树中的文本节点，删除没有文本的空文本节点和合并相邻本应为一个文本节点的多个文本节点(无其他类型节点分隔，却被解析成多个文本节点的情况)
    -------------------------------------|------------------------------------------------------------------------------
    node.append(els || strs)             |   IE不支持，在node内部后面插入单个或一组DOM元素/字符串文本(传入多个参数即为一组，可元素与字符串混合，元素也可以是一组NodeList)
    -------------------------------------|------------------------------------------------------------------------------
    node.prepend(els || strs)            |   IE不支持，在node内部前面插入单个或一组DOM元素/字符串文本
    -------------------------------------|------------------------------------------------------------------------------
    node.before(els || strs)             |   IE不支持，在node外部前面插入单个或一组DOM元素/字符串文本
    -------------------------------------|------------------------------------------------------------------------------
    node.after(els || strs)              |   IE不支持，在node外部后面插入单个或一组DOM元素/字符串文本
    -------------------------------------|------------------------------------------------------------------------------
    node.replaceWith(els || strs)        |   IE不支持，将node替换成单个或一组DOM元素/字符串文本
    -------------------------------------|------------------------------------------------------------------------------
    node.remove()                        |   IE不支持，删除当前node节点
    -------------------------------------|------------------------------------------------------------------------------
    DocumentFragment                     |   所有浏览器都支持，这是一个特殊的DOM节点，其主要用于包装一组元素从而被当做是一个元素，可假设是一个template元素可包含多个其他元素但其本身并无实质的标签,
                                         |   用法举例：
                                         |   const wrapEl = new DocumentFragment(); // 创建一个包装元素
                                         |   wrapEl.appendChild(el1); wrapEl.appendChild(el2); // 多次向包装元素中插入其他元素
                                         |   document.body.appendChild(wrapEl); // wrapEl一个整体元素插入到body(或其他元素中)，wrapEl本身并不会产生实际标签，结果就像直接向body中插入el1、el2一样
    -------------------------------------|------------------------------------------------------------------------------


    /*================================================================================================================*/
    /*================================================ Document文档节点 ================================================*/
    /*================================================================================================================*/
    document对象为文档对象，表示整个HTML页面(不是html这一个元素)，其是window对象的一个属性，所以可作为全局对象访问。
    document.nodeType === 9
    document.nodeName === "#document"
    document.nodeValue === null
    document.parentNode === null
    document.ownerDocument === null
    -------------------------------------|------------------------------------------------------------------------------
    document.documentElement             |   ‘documentElement’属性指向HTML页面中的&lt;html>元素
    -------------------------------------|------------------------------------------------------------------------------
    document.body                        |   ‘body’属性指向body元素的引用
    -------------------------------------|------------------------------------------------------------------------------
    document.childNodes                  |   注意：文档的子节点是从整个HTML页面来看的（所以可能包含文档类型声明节点、注释节点等）
    -------------------------------------|------------------------------------------------------------------------------
    document.doctype                     |   ‘doctype’属性指向对文档声明的引用（即&lt;!DOCTYPE html>），IE8-中为null
    -------------------------------------|------------------------------------------------------------------------------
    document.title                       |   ‘title’属性保存着页面title，即head下title标签中的文本，可读可写
    -------------------------------------|------------------------------------------------------------------------------
    document.URL                         |   ‘URL’属性(注意大写)保存着页面完整的url地址(即地址栏中显示的url，注意是编码过后的值)，只读
    -------------------------------------|------------------------------------------------------------------------------
    document.domain                      |   ‘domain’属性保存着页面的域名，
                                         |   可写，但只能设置向上级域名设置，不能设置为所在URL中不存在的域名；如：原域名‘p2p.wrox.com’，只能将domain设置为‘wrox.com’
    -------------------------------------|------------------------------------------------------------------------------
    document.referrer                    |   ‘referrer’属性保存着链接到当前页面的那个页面的URL，只读；若没有来源页面跳转过来，则该属性返回空字符串
    =====================================|==============================================================================
    document.getElementById(id)          |   该方法用于获取到指定id的元素，id要严格匹配区分大小写；若有多个相同id的元素，则只返回最先出现的那一个元素
    -------------------------------------|------------------------------------------------------------------------------
    document.getElementsByTagName(tag)   |   该方法用于获取指定tag标签名的元素集(HTMLCollection对象，类似NodeList，见顶部说明)，传入星号‘*’则能获取文档中的所有元素
    -------------------------------------|------------------------------------------------------------------------------
    document.getElementsByName(name)     |   该方法用于获取指定name元素名的元素集HTMLCollection，最常用于获取单复选框这种有一组相同name的表单元素
    =====================================|==============================================================================
    document.anchors                     |   该属性包含文档中所有带‘name’属性的&lt;a&gt;元素
    -------------------------------------|------------------------------------------------------------------------------
    document.links                       |   该属性包含文档中所有带‘href’属性的&lt;a&gt;元素
    -------------------------------------|------------------------------------------------------------------------------
    document.forms                       |   该属性包含文档中所有的&lt;form&gt;元素，与document.getElementsByTagName('form')结果相同
    -------------------------------------|------------------------------------------------------------------------------
    document.images                      |   该属性包含文档中所有的&lt;img&gt;元素，与document.getElementsByTagName('img')结果相同
    =====================================|==============================================================================
    document.implementation.hasFeature(DOM功能名, DOM级别版本号)
                                         |   该方法用于检测当前浏览器是否支持某个DOM级别中的某个DOM功能，返回布尔值，如传参(MutationEvents, 3.0)表示检测是否支持DOM3级中的DOM树变化事件
                                         |   注意该方法的检测结果不一定准确(浏览器不一定按规范返回)，对于DOM的某些特殊功能除了使用该方法检测外还应使用能力检测
    -------------------------------------|------------------------------------------------------------------------------
    document.open()                      |   打开一个要写入内容的文档，注意：当`document.write()`在页面加载后调用，会发生自动的`document.open()`调用
    -------------------------------------|------------------------------------------------------------------------------
    document.write(str)                  |   这两个方法都是将字符串str写入到文档中，且支持HTML标签（包括插入的script内容也是可运行的，而innerHTML插入的是不能运行的）
    document.writeln(str)                |   write()方法是按默认格式写入，而writeln()方法会在字符串末尾插入一个换行符(\n)
                                         |   注意：这两个方法可以通过script标签放在body内任何元素中，输出的字符串就显示在标签所在位置，
                                         |        但若等文档加载完调用或者放在文档最后调用(因代码从上往下解析，所以也相当于各元素已加载完)，这时两个方法输出的内容就将覆盖整个页面
    -------------------------------------|------------------------------------------------------------------------------
    document.close()                     |   关闭前面`document.open()`打开的文档
    -------------------------------------|------------------------------------------------------------------------------

</code></pre>
<pre><code class="css" id="show-script"></code></pre>
<div id="div">div包裹的文本节点
    <ul id="ul">
        <li id="liid" name="liname">li1</li>
        <li>li2</li>
        <li>li3</li>
        <li>li4</li>
    </ul>
</div>
<script type="text/javascript" charset="UTF-8">
    var div = document.getElementById('div');
</script>
<script type="text/javascript" charset="UTF-8" id="script">

    console.log(div.nodeType);   //1，表示其为元素节点
    console.log(div.nodeValue);   //null，元素节点的nodeValue始终为null
    console.log(div.cloneNode(true));   //包含div节点及其内部所有内容
    console.log(div.cloneNode(false));   //只包含&lt;div id="div">&lt;/div>一层

</script>
<script>
    document.getElementById('show-script').innerHTML = document.getElementById('script').innerHTML;
</script>
</body>
</html>